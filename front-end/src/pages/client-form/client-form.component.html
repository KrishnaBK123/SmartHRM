<mat-card>
  <div class="showBanner add-client-banner">
    <span>{{ formHeading }}</span>
    <button mat-icon-button class="close-button" (click)="closeDialog()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <br>

  <div class="section">
    <h6>Company Details</h6>
    <div class="form-row">
      <mat-form-field appearance="fill" style="flex: 1; margin-right: 8px;">
        <mat-label>Company Name *</mat-label>
        <input matInput type="text" placeholder="Enter company name"
               [(ngModel)]="client.cl_name" required>
        <mat-error *ngIf="submitted && !client.cl_name">Company Name is required.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1;">
        <mat-label>Company Type</mat-label>
        <mat-select [(ngModel)]="client.cl_type">
          <mat-option value="" disabled>Select company type</mat-option>
          <mat-option value="Service Based">Service Based</mat-option>
          <mat-option value="Product Based">Product Based</mat-option>
          <mat-option value="Both">Both</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="form-row" style="margin-top: 16px;">
      <mat-form-field appearance="fill" style="flex: 1; margin-right: 8px;">
        <mat-label>Company Email *</mat-label>
        <input matInput type="email" placeholder="Enter company email"
               [(ngModel)]="client.cl_email" required>
        <mat-error *ngIf="submitted && !isEmailValid(client.cl_email)">Valid Email is required.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1;">
        <mat-label>Phone Number *</mat-label>
        <input matInput type="tel" placeholder="Enter phone number with country code"
               [(ngModel)]="client.cl_phno" required>
        <mat-error *ngIf="submitted && !isPhoneNumberValid(client.cl_phno)">Phone number must include country code.</mat-error>
      </mat-form-field>
    </div>

    <div class="form-row" style="margin-top: 16px;">
      <mat-form-field appearance="fill" style="flex: 1; margin-right: 8px;">
        <mat-label>Address</mat-label>
        <input matInput type="text" placeholder="Enter company address"
               [(ngModel)]="client.cl_addr">
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1;">
        <mat-label>Map Link</mat-label>
        <input matInput type="text" placeholder="Enter map link (URL)"
               [(ngModel)]="client.cl_map_url">
      </mat-form-field>
    </div>

    <mat-form-field appearance="fill" style="width: 100%; margin-top: 16px;">
      <mat-label>Clients Notes</mat-label>
      <textarea matInput rows="3" [(ngModel)]="client.cl_notes"></textarea>
      <mat-error *ngIf="submitted"></mat-error>
    </mat-form-field>
  </div>

  <div class="section">
    <h6>Primary Contact Person</h6>
    <div class="form-row" style="display: flex; flex-wrap: wrap; margin-bottom: 16px;">
      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Name *</mat-label>
        <input matInput type="text" placeholder="Enter name"
               [(ngModel)]="client.contacts[0].co_name" required>
        <mat-error *ngIf="submitted && !client.contacts[0].co_name">Name is required.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Hiring Position</mat-label>
        <input matInput type="text" placeholder="Enter hiring position"
               [(ngModel)]="client.contacts[0].co_position_hr">
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Phone No. *</mat-label>
        <input matInput type="tel" placeholder="Enter Phone No."
               [(ngModel)]="client.contacts[0].co_phno" required>
        <mat-error *ngIf="submitted && !isPhoneNumberValid(client.contacts[0].co_phno)">Phone number must include country code.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px;">
        <mat-label>Email *</mat-label>
        <input matInput type="email" placeholder="Enter Email"
               [(ngModel)]="client.contacts[0].co_email" required>
        <mat-error *ngIf="submitted && !isEmailValid(client.contacts[0].co_email)">Valid Email is required.</mat-error>
      </mat-form-field>
    </div>

    <div *ngFor="let contact of client.contacts.slice(1); let i = index" class="form-row" style="display: flex; flex-wrap: wrap; margin-bottom: 16px;">
      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Name</mat-label>
        <input matInput type="text" placeholder="Enter name"
               [(ngModel)]="contact.co_name">
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Hiring Position</mat-label>
        <input matInput type="text" placeholder="Enter hiring position"
               [(ngModel)]="contact.co_position_hr">
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px; margin-right: 8px;">
        <mat-label>Phone No.</mat-label>
        <input matInput type="tel" placeholder="Enter Phone No."
               [(ngModel)]="contact.co_phno">
        <mat-error *ngIf="submitted && !isPhoneNumberValid(contact.co_phno)">Phone number must include country code.</mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" style="flex: 1; min-width: 250px;">
        <mat-label>Email</mat-label>
        <input matInput type="email" placeholder="Enter Email"
               [(ngModel)]="contact.co_email">
        <mat-error *ngIf="submitted ">Valid Email is required.</mat-error>
      </mat-form-field>

      <button mat-icon-button (click)="removeContactPerson(i + 1)" class="remove-button">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>

  <div class="button-container" style="margin-top: 16px;">
    <button mat-raised-button color="primary" (click)="addContactPerson()" 
            [disabled]="client.contacts.length >= 5">Add contact person</button>
    <button mat-raised-button color="accent" (click)="onSubmit()" 
            [disabled]="!isFormValid()">Submit</button>
  </div>
</mat-card>
