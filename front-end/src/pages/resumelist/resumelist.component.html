<div class="resume-section">
  <!-- Client Name and Position Name Search Section -->
  <div class="search-section">
    <div class="input-bar">
      <label for="clientSelect">Select Client Name:</label>
      <p-dropdown 
        id="clientSelect" 
        [(ngModel)]="selectedClientId" 
        (onChange)="onClientChange()" 
        [options]="clients" 
        optionLabel="cl_name"  
        optionValue="cl_id"   
        [filter]="true" 
        placeholder="Select Client Name">
      </p-dropdown>

      <label for="positionSelect">Select Position Name:</label>
      <p-dropdown 
        id="positionSelect" 
        [(ngModel)]="selectedPosition" 
        (onChange)="onPositionSelect()" 
        [options]="positions" 
        optionLabel="filename"  
        optionValue="jd_id" 
        [filter]="true" 
        placeholder="Select Position Name">
      </p-dropdown>

      <button (click)="fetchResumes()">Search</button>
    </div>
  </div>

  <!-- Resume Table Section -->
  <div class="resume-table-section">
    <!-- Count of Resumes placed before the table -->
    <div class="resume-count">
      <span>Total Resumes: {{ resumes.length }}</span>
    </div>

    <!-- Resume Table -->
    <div class="resume-table">
      <table>
        <thead>
          <tr>
            <th>File Name</th>
            <th>
              Date 
              <i class="fas fa-sort-up" (click)="sortResumes('asc')" style="cursor: pointer;"></i>
              <i class="fas fa-sort-down" (click)="sortResumes('desc')" style="cursor: pointer;"></i>
            </th>
            <th>Time</th>
            <th>Status</th>
            <th>Download</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <!-- Skeleton loader for loading state -->
          <ng-container *ngIf="isLoadingResumes">
            <tr *ngFor="let i of [1,2,3,4,5,6,7,8,9]" class="skeleton-row">
              <td><p-skeleton></p-skeleton></td>
              <td><p-skeleton></p-skeleton></td>
              <td><p-skeleton></p-skeleton></td>
              <td><p-skeleton></p-skeleton></td>
              <td><p-skeleton></p-skeleton></td>
              <td><p-skeleton></p-skeleton></td>
            </tr>
          </ng-container>
          <!-- Actual data -->
          <ng-container *ngIf="!isLoadingResumes">
            <tr *ngFor="let resume of resumes">
              <td>{{ resume.filename }}</td>
              <td>{{ formatDate(resume.created_at) }}</td>
              <td>{{ formatTime(resume.created_at) }}</td>
              <td>
                <mat-form-field appearance="fill">
                  <mat-select [(ngModel)]="resume.st_id" (selectionChange)="onStatusChange(resume)">
                    <mat-option value="" disabled>Select Status</mat-option>
                    <mat-option *ngFor="let status of statusOptions" [value]="status.st_id">{{ status.st_name }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </td>                        
              <td>
                <button class="download-btn" (click)="downloadResume(resume)">
                  <i class="bi bi-download"></i> Download
                </button>
              </td>
              <td>
                <button class="view-btn" (click)="viewResume(resume)">View</button>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>

